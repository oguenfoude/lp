# ๐ ุฏููู ุงูุฅุนุฏุงุฏ ุงูุณุฑูุน - ุฅุตุฏุงุฑ ุงูุชุซุจูุช ุงูุชููุงุฆู

## โจ ุงูุฌุฏูุฏ: ุตูุฑ ุฅุนุฏุงุฏ ูุฏูู!

**ุงูุขู ูุง ุญุงุฌุฉ ูุฅูุดุงุก Google Sheet ูุณุจูุงู - ูู ุดูุก ุชููุงุฆู! ๐**

---

## ๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ (5 ุฏูุงุฆู)

### 1๏ธโฃ ูุณุฎ ุงูููุฏ

```
1. ุงูุชุญ: d:\lp\google-apps-script\OrdersWebhook.gs
2. ุงูุณุฎ ุงูููุฏ ุจุงููุงูู (Ctrl+A ุซู Ctrl+C)
```

---

### 2๏ธโฃ ุฅูุดุงุก ูุดุฑูุน Apps Script

```
1. ุงูุชุญ: https://script.google.com/home
2. ุงุถุบุท: New Project
3. ุงูุตู ุงูููุฏ (Ctrl+V)
4. ุณูู ุงููุดุฑูุน: "Orders Webhook" (ุฃููููุฉ ุงูููู ุจุฌุงูุจ Untitled project)
5. ุงุญูุธ: Ctrl+S
```

---

### 3๏ธโฃ ุชุนุฏูู ุงูููุชุงุญ ุงูุณุฑู (ุงุฎุชูุงุฑู)

```javascript
// ูู ุงูุณุทุฑ 34 ุชูุฑูุจุงู
SECRET_KEY: 'ุถุน-ููุชุงุญ-ููู-ููุง-2025',
```

**โ๏ธ ููู:** ุบููุฑ ุงูููุชุงุญ ูุดูุก ุฎุงุต ุจูุ ุฃู ุงุชุฑูู ูุงุฑุบุงู `''` ูุชุนุทูู ุงูุญูุงูุฉ.

---

### 4๏ธโฃ ูุดุฑ ูู Web App

```
1. ุงุถุบุท: Deploy > New deployment
2. ุงุฎุชุฑ Type: Web app
3. ุงูุฅุนุฏุงุฏุงุช:
   โ Description: Orders Webhook v1
   โ Execute as: Me
   โ Who has access: Anyone
4. ุงุถุบุท: Deploy
5. ููุงููุฉ ุงูุฃุฐููุงุช:
   - Review Permissions
   - ุงุฎุชุฑ ุญุณุงุจู
   - Advanced > Go to "Orders Webhook" (unsafe)
   - Allow
```

---

### 5๏ธโฃ ุงุญูุธ ุฑุงุจุท Web App

```
ุจุนุฏ ุงููุดุฑ ุณุชุญุตู ุนูู:
Web app URL: https://script.google.com/macros/s/AKfy.../exec

๐ ุงูุณุฎ ูุฐุง ุงูุฑุงุจุท
```

---

### 6๏ธโฃ ุชุญุฏูุซ `.env.local`

```env
# ุงูุชุญ: d:\lp\.env.local

# ุถุน ุงูุฑุงุจุท ูู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ
GSHEETS_WEBAPP_URL="https://script.google.com/macros/s/YOUR_ID/exec"

# ููุณ ุงูููุชุงุญ ูู ุงูุฎุทูุฉ 3
GSHEETS_SECRET_KEY="ููุณ-ุงูููุชุงุญ-ูู-ุงูููุฏ"

# ูุนูู ุงูุชูุงูู
INTEGRATION_ENABLED=true
```

---

### 7๏ธโฃ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู

```bash
# ูู PowerShell
cd d:\lp
npm run dev
```

---

### 8๏ธโฃ ุงุฎุชุจุงุฑ (ุฎูุงุฑุงุช)

#### ุงูุฎูุงุฑ ุฃ: ุงุฎุชุจุงุฑ ูู Apps Script
```
1. ูู ูุญุฑุฑ Apps Script
2. ุงุฎุชุฑ ุงูุฏุงูุฉ: testWebhook
3. ุงุถุบุท: Run
4. ุชุญูู ูู Execution log
```

#### ุงูุฎูุงุฑ ุจ: ุงุฎุชุจุงุฑ ูู ุงููุชุตูุญ
```
1. ุงูุชุญ ุฑุงุจุท Web App ูู ูุชุตูุญ
   https://script.google.com/macros/s/YOUR_ID/exec
   
2. ูุฌุจ ุฃู ุชุฑู:
   {
     "success": true,
     "message": "Orders Webhook is active!",
     "data": {
       "spreadsheetUrl": "ุฑุงุจุท ุงูุดูุช",
       "spreadsheetId": "ูุนุฑู ุงูุดูุช"
     }
   }
   
3. ุงูุณุฎ spreadsheetUrl ูุงูุชุญู - ูุฐุง ุดูุชู! ๐
```

#### ุงูุฎูุงุฑ ุฌ: ุงุฎุชุจุงุฑ ูู ุงููููุน
```
1. ุงูุชุญ: http://localhost:3000
2. ุงููุฃ ูููุฐุฌ ุงูุทูุจ
3. ุงุถุบุท: ุชุฃููุฏ ุงูุทูุจ
4. ุงูุชุญ ุฑุงุจุท ุงูุดูุช ูู ุงูุฎูุงุฑ ุจ
5. ุชุญูู ูู ุธููุฑ ุงูุทูุจ โ
```

---

## ๐ฏ ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ

### โ ุฅูุดุงุก ุชููุงุฆู ููุดูุช
```
- ุฃูู ุทูุจ ููุดุฆ ุงูุดูุช ุชููุงุฆูุงู
- ุงุณู ุงูุดูุช: "Landing Pages Orders - YYYY-MM-DD"
- ุงูุฃุนูุฏุฉ ุชููุดุฃ ุชููุงุฆูุงู
- ุงูุชูุณูู ููุทุจู ุชููุงุฆูุงู
```

### โ ุงูุญุตูู ุนูู ุฑุงุจุท ุงูุดูุช
```
ูู Apps Script:
1. ุงุฎุชุฑ ุงูุฏุงูุฉ: getSpreadsheetUrl
2. ุงุถุบุท: Run
3. ุงูุฑุงุจุท ูุธูุฑ ูู Execution log
```

ุฃู:

```
ุงูุชุญ ุฑุงุจุท Web App ูู ุงููุชุตูุญ:
https://script.google.com/macros/s/YOUR_ID/exec

ุงูุฑุงุจุท ูุธูุฑ ูู ุงูู JSON response
```

### โ ุดูุช ูุงุญุฏ ููู ุงูุนููุงุก (ุงุฎุชูุงุฑู)
```
ุฅุฐุง ุชุฑูุฏ ุดูุช ูุณุชูู ููู ุนููู:
1. ุบููุฑ GSHEETS_SHEET_NAME ูู .env.local
   GSHEETS_SHEET_NAME="Orders-Client1"
   
2. ูู ุนููู ุณูุญุตู ุนูู ูุฑูุฉ ูููุตูุฉ ูู ููุณ ุงูุดูุช
```

---

## ๐ ูููู ุงูุดูุช

```
Spreadsheet: Landing Pages Orders - 2025-11-23
โโโ Orders (ุงูุงูุชุฑุงุถูุฉ)
โ   โโโ ุงูุชุงุฑูุฎ ูุงูููุช
โ   โโโ ุฑูู ุงูุทูุจ
โ   โโโ ุงุณู ุงููุชุฌุฑ
โ   โโโ ุงูููุชุฌ
โ   โโโ ุงูุณุนุฑ
โ   โโโ ุงููููุฉ
โ   โโโ ููุน ุงูุชูุตูู
โ   โโโ ุฑุณูู ุงูุชูุตูู
โ   โโโ ุงูุฅุฌูุงูู
โ   โโโ ุงุณู ุงูุนููู
โ   โโโ ุงููุงุชู
โ   โโโ ุงูููุงูุฉ
โ   โโโ ุงูุจูุฏูุฉ
โ   โโโ ุงูุนููุงู
โ   โโโ ููุงุญุธุงุช
โ   โโโ ููุช ุงูุชูุตูู
โ   โโโ ุงูุญุงูุฉ
โโโ Orders-Client2 (ุฅุฐุง ุฃุถูุช ุนููู ุขุฎุฑ)
```

---

## ๐ง ุญู ุงููุดุงูู

### ูุดููุฉ: "Cannot read properties of null"
```
โ ุงูุญู: ุชู ุฅุตูุงุญู! ุงูููุฏ ุงูุฌุฏูุฏ ููุดุฆ ุงูุดูุช ุชููุงุฆูุงู
```

### ูุดููุฉ: "Unauthorized"
```
โ ุชุญูู ูู:
- GSHEETS_SECRET_KEY ูู .env.local ูุทุงุจู SECRET_KEY ูู ุงูููุฏ
- ุฃู ุนุทูู ุงูุญูุงูุฉ ุจุฌุนู SECRET_KEY: ''
```

### ูุดููุฉ: ูุง ุฃุนุฑู ุฑุงุจุท ุงูุดูุช
```
โ ุทุฑููุฉ 1: ุงูุชุญ ุฑุงุจุท Web App ูู ุงููุชุตูุญ
โ ุทุฑููุฉ 2: ุดุบูู getSpreadsheetUrl ูู Apps Script
โ ุทุฑููุฉ 3: ุงูุชุญ Google Drive ูุงุจุญุซ ุนู "Landing Pages Orders"
```

### ูุดููุฉ: ุฃุฑูุฏ ุดูุช ุฌุฏูุฏ ููู ุนููู
```
โ ุงูุญู:
1. ููุณ ุงูููุฏ (ูุง ุชุบููุฑ)
2. ููู ุนููู: ุบููุฑ GSHEETS_SHEET_NAME ูู .env.local
3. ูู ุนููู ุณูุญุตู ุนูู ูุฑูุฉ ูููุตูุฉ ูู ููุณ ุงูุดูุช
```

---

## ๐ ูุซุงู ูุงูู ููุนููู ุงูุซุงูู

### ููู `.env.local` (ุนููู 2)

```env
# ูุนูููุงุช ุงูุนููู
NEXT_PUBLIC_SITE_NAME="ุนููู 2"
NEXT_PUBLIC_PRODUCT_NAME="ููุชุฌ ุนููู 2"
# ... ุจุงูู ุงููุตูุต

# Google Sheets (ููุณ ุงูุฅุนุฏุงุฏุงุช!)
GSHEETS_WEBAPP_URL="https://script.google.com/macros/s/SAME_ID/exec"
GSHEETS_SECRET_KEY="same-secret-key"
GSHEETS_SHEET_NAME="Orders-Client2"  # โฌ๏ธ ููุท ูุฐุง ูุชุบูุฑ
INTEGRATION_ENABLED=true
```

**ุงููุชูุฌุฉ:**
```
ููุณ ุงูุดูุชุ ูุฑูุฉ ุฌุฏูุฏุฉ:
- Orders (ุนููู 1)
- Orders-Client2 (ุนููู 2)
- Orders-Client3 (ุนููู 3)
...
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

```
โ ูุณุฎุช ุงูููุฏ ูู OrdersWebhook.gs
โ ุฃูุดุฃุช ูุดุฑูุน ูู script.google.com
โ ุบููุฑุช SECRET_KEY (ุฃู ุนุทููุชู)
โ ูุดุฑุช ูู Web app (Anyone access)
โ ุญุตูุช ุนูู ุฑุงุจุท Web App
โ ูุถุนุช ุงูุฑุงุจุท ูู .env.local
โ ูุถุนุช ููุณ SECRET_KEY ูู .env.local
โ INTEGRATION_ENABLED=true
โ npm run dev
โ ุงุฎุชุจุฑุช ูู ุงููุชุตูุญ ุฃู testWebhook
โ ุญุตูุช ุนูู ุฑุงุจุท ุงูุดูุช
โ ุชุญูู ูู ุธููุฑ ุทูุจ ุชุฌุฑูุจู
```

---

## ๐ ูุจุฑูู!

**ุงูุขู ูุฏูู:**
- โ ุชูุงูู ุชููุงุฆู ูุงูู ูุน Google Sheets
- โ ูุง ุญุงุฌุฉ ูุฅูุดุงุก ุดูุช ูุณุจูุงู
- โ ุดูุช ูุงุญุฏ ููู ุงูุนููุงุก (ุฃูุฑุงู ูููุตูุฉ)
- โ ุณูููุฉ ุงููุณุฎ ููุนููุงุก ุงูุฌุฏุฏ

**ูู ุดูุก ูุนูู ุชููุงุฆูุงู! ๐**

---

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

### ุงูุฃูุงู
```
โ Web App ูุนูู ุจุตูุงุญูุงุชู (Execute as: Me)
โ ุงูุดูุช ูู ุญุณุงุจู (ุฃูุช ุงููุงูู)
โ ููููู ูุดุงุฑูุฉ ุงูุดูุช ูุน ุงูุนููู (View/Edit)
```

### ุงูุฃุฏุงุก
```
โ Google Sheets ูุฏุนู ููุงููู ุงูุฎูุงูุง
โ Apps Script ุณุฑูุน ูููุซูู
โ Retry logic ูุฏูุฌ ูู API Route
```

### ุงูุชูุณุน
```
โ ูุฑูุฉ ุฌุฏูุฏุฉ ููู ุนููู (ูู ููุณ ุงูุดูุช)
โ ุฃู ุดูุช ุฌุฏูุฏ ุชูุงูุงู (ุบููุฑ MAIN_SPREADSHEET_NAME)
โ ุฃู ุงูุชูู ูู Airtable/Database ูุงุญูุงู
```

---

**ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูููุฑู! ๐ฏ**
