# ๐ ุฏููู ุงูุฅุนุฏุงุฏ ุงููุงูู - Google Sheets Integration

## ๐ ุงููุญุชููุงุช
1. [ุฅุนุฏุงุฏ Google Sheet](#1-ุฅุนุฏุงุฏ-google-sheet)
2. [ูุดุฑ Apps Script](#2-ูุดุฑ-apps-script)
3. [ุฅุนุฏุงุฏ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ](#3-ุฅุนุฏุงุฏ-ุงููุชุบูุฑุงุช-ุงูุจูุฆูุฉ)
4. [ุงุฎุชุจุงุฑ ุงูุชูุงูู](#4-ุงุฎุชุจุงุฑ-ุงูุชูุงูู)
5. [ูุณุฎ ููุนููุงุก ุงูุฌุฏุฏ](#5-ูุณุฎ-ููุนููุงุก-ุงูุฌุฏุฏ)
6. [ุญู ุงููุดุงูู](#6-ุญู-ุงููุดุงูู)

---

## 1๏ธโฃ ุฅุนุฏุงุฏ Google Sheet

### ุงูุฎุทูุฉ 1.1: ุฅูุดุงุก Google Sheet ุฌุฏูุฏ
```
1. ุงูุชุญ Google Drive (drive.google.com)
2. New > Google Sheets > Blank spreadsheet
3. ุณูููุง: "ุนููู - ุงุณู ุงูููุชุฌ - Orders" ูุซูุงู
4. ุณูุชู ุฅูุดุงุก ุงูุฃุนูุฏุฉ ุชููุงุฆูุงู ุนูุฏ ุฃูู ุทูุจ
```

### ุงูุฎุทูุฉ 1.2: ุงุญูุธ ูุนุฑูู ุงูุดูุช (ุงุฎุชูุงุฑู)
```
ูู ุฑุงุจุท ุงูุดูุช:
https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}/edit

ุงุญูุธ SPREADSHEET_ID ููุฑุฌูุน ุฅููู ูุงุญูุงู
```

---

## 2๏ธโฃ ูุดุฑ Apps Script

### ุงูุฎุทูุฉ 2.1: ูุชุญ ูุญุฑุฑ Apps Script
```
1. ูู Google Sheet: Extensions > Apps Script
2. ุณููุชุญ ูุญุฑุฑ ุฌุฏูุฏ
3. ุงุญุฐู ุฃู ููุฏ ููุฌูุฏ
```

### ุงูุฎุทูุฉ 2.2: ูุณุฎ ุงูููุฏ
```
1. ุงูุชุญ ุงูููู: d:\lp\google-apps-script\OrdersWebhook.gs
2. ุงูุณุฎ ุงูููุฏ ุจุงููุงูู (Ctrl+A ุซู Ctrl+C)
3. ุงูุตู ูู ูุญุฑุฑ Apps Script (Ctrl+V)
```

### ุงูุฎุทูุฉ 2.3: ุชุนุฏูู ุงูุฅุนุฏุงุฏุงุช (ุงุฎุชูุงุฑู)
```javascript
const CONFIG = {
  DEFAULT_SHEET_NAME: 'Orders',  // ุบููุฑู ุฅุฐุง ุฃุฑุฏุช ุงุณู ูุฎุชูู
  SECRET_KEY: 'your-secret-key-here',  // โ๏ธ ููู: ุบููุฑู ูููุชุงุญ ููู
  DEBUG_MODE: false  // true ููุท ููุชุทููุฑ
};
```

### ุงูุฎุทูุฉ 2.4: ุญูุธ ุงููุดุฑูุน
```
1. ุงุถุบุท ุนูู ุฃููููุฉ ุงููุฑุต (Save) ุฃู Ctrl+S
2. ุณูู ุงููุดุฑูุน: "Orders Webhook"
```

### ุงูุฎุทูุฉ 2.5: ูุดุฑ ูู Web App
```
1. ุงุถุบุท Deploy > New deployment
2. ุงุฎุชุฑ Type: Web app
3. ุฅุนุฏุงุฏุงุช:
   - Description: Orders Webhook v1
   - Execute as: Me (ุจุฑูุฏู ุงูุฅููุชุฑููู)
   - Who has access: Anyone
4. ุงุถุบุท Deploy
5. ุณุชุญุชุงุฌ ููููุงููุฉ:
   - Review Permissions
   - ุงุฎุชุฑ ุญุณุงุจู
   - Advanced > Go to [Project Name] (unsafe)
   - Allow
```

### ุงูุฎุทูุฉ 2.6: ุงุญูุธ ุฑุงุจุท Web App
```
ุจุนุฏ ุงููุดุฑุ ุณุชุญุตู ุนูู:
Web app URL: https://script.google.com/macros/s/xxxxx/exec

โ๏ธ ููู ุฌุฏุงู: ุงูุณุฎ ูุฐุง ุงูุฑุงุจุท - ุณุชุญุชุงุฌู ูู ุงูุฎุทูุฉ ุงูุชุงููุฉ
```

---

## 3๏ธโฃ ุฅุนุฏุงุฏ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ

### ุงูุฎุทูุฉ 3.1: ูุชุญ ููู ุงูุจูุฆุฉ
```
ุงูุชุญ ุงูููู: d:\lp\.env.local
```

### ุงูุฎุทูุฉ 3.2: ุชุนุฏูู ุฅุนุฏุงุฏุงุช Google Sheets
```env
# ุถุน ุฑุงุจุท Web App ููุง
GSHEETS_WEBAPP_URL="https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec"

# ููุณ ุงูููุชุงุญ ุงูุฐู ูุถุนุชู ูู Apps Script
GSHEETS_SECRET_KEY="your-secret-key-here"

# ุงุณู ุงููุฑูุฉ (ููุณ ุงูุงุณู ูู Apps Script)
GSHEETS_SHEET_NAME="Orders"

# ูุนูู ุงูุชูุงูู
INTEGRATION_ENABLED=true
```

### ุงูุฎุทูุฉ 3.3: ุญูุธ ุงูููู
```
Ctrl+S
```

---

## 4๏ธโฃ ุงุฎุชุจุงุฑ ุงูุชูุงูู

### ุงูุฎุทูุฉ 4.1: ุงุฎุชุจุงุฑ ูู Apps Script (ุงุฎุชูุงุฑู)
```
1. ูู ูุญุฑุฑ Apps Script
2. ุงุฎุชุฑ ุงูุฏุงูุฉ: testWebhook
3. ุงุถุบุท Run
4. ุชุญูู ูู ุงูุดูุช - ูุฌุจ ุฃู ูุธูุฑ ุตู ุฌุฏูุฏ
```

### ุงูุฎุทูุฉ 4.2: ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู ุงููุญูู
```bash
# ุฃููู ุงูุฎุงุฏู (Ctrl+C)
npm run dev

# ุงูุชุธุฑ ุญุชู ูุจุฏุฃ
# โ Ready on http://localhost:3000
```

### ุงูุฎุทูุฉ 4.3: ุงุฎุชุจุงุฑ ูู ุงููููุน
```
1. ุงูุชุญ http://localhost:3000
2. ุงููุฃ ูููุฐุฌ ุงูุทูุจ ุจุงููุงูู
3. ุงุถุบุท "ุชุฃููุฏ ุงูุทูุจ"
4. ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ: "โ ุชู ุงุณุชูุงู ุทูุจู!"
5. ุงูุชุญ Google Sheet - ุชุญูู ูู ุธููุฑ ุงูุทูุจ
```

### ุงูุฎุทูุฉ 4.4: ุงูุชุญูู ูู ุงูุจูุงูุงุช
```
ูู Google Sheetุ ุชุญูู ูู:
โ ูู ุงูุฃุนูุฏุฉ ุธูุฑุช ุชููุงุฆูุงู
โ ุงูุจูุงูุงุช ุตุญูุญุฉ ูููุชููุฉ
โ ุงูุชุงุฑูุฎ ูุงูููุช ุตุญูุญ
โ ุชู ุชุจุณูุท ุงูุฃุนูุฏุฉ (ุฅุฒุงูุฉ ุฑูู ุงูุทูุจ ูุงุณู ุงููุชุฌุฑ ูููุช ุงูุชูุตูู ุญุณุจ ุขุฎุฑ ุชุญุฏูุซ)
```

---

## 5๏ธโฃ ูุณุฎ ููุนููุงุก ุงูุฌุฏุฏ

### ุนููู ุฌุฏูุฏ - ุงูุทุฑููุฉ ุงูุณุฑูุนุฉ (5 ุฏูุงุฆู)

#### ุงูุฎุทูุฉ 5.1: ูุณุฎ Google Sheet
```
1. ูู Google Driveุ ุงูุณุฎ ุงูุดูุช ุงูุฃุณุงุณู
2. Right-click > Make a copy
3. ุณููู: "ุนููู 2 - ููุชุฌ X - Orders"
```

#### ุงูุฎุทูุฉ 5.2: ููุณ Apps Script (ูุง ุญุงุฌุฉ ููุดุฑ ุฌุฏูุฏ)
```
โ ุงุณุชุฎุฏู ููุณ GSHEETS_WEBAPP_URL
โ ููุณ GSHEETS_SECRET_KEY
```

#### ุงูุฎุทูุฉ 5.3: ูุณุฎ ูุฌูุฏ ุงููุดุฑูุน
```bash
# ูู PowerShell
cd d:\
cp -r lp client-name
cd client-name
```

#### ุงูุฎุทูุฉ 5.4: ุชุนุฏูู .env.local ููุนููู ุงูุฌุฏูุฏ
```env
NEXT_PUBLIC_SITE_NAME="ุนููู ุฌุฏูุฏ"
NEXT_PUBLIC_PRODUCT_NAME="ููุชุฌ ุฌุฏูุฏ"
# ... ุฅูุฎ (ุนุฏูู ูู ุงููุตูุต)

# ุฅุนุฏุงุฏุงุช Google Sheets (ููุณูุง)
GSHEETS_WEBAPP_URL="https://script.google.com/macros/s/xxxxx/exec"
GSHEETS_SECRET_KEY="your-secret-key-here"
GSHEETS_SHEET_NAME="Orders-Client2"  # โฌ๏ธ ููุท ุบููุฑ ุงุณู ุงููุฑูุฉ
```

#### ุงูุฎุทูุฉ 5.5: ุชุดุบูู
```bash
npm run dev
```

**ุฌุงูุฒ! โ**

---

## 6๏ธโฃ ุญู ุงููุดุงูู

### ูุดููุฉ: "ุฎุทุฃ ูู ุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู"
```
โ ุงูุญู:
1. ุชุฃูุฏ ูู ูุฌูุฏ GSHEETS_WEBAPP_URL ูู .env.local
2. ุชุฃูุฏ ูู ูุฌูุฏ GSHEETS_SECRET_KEY
3. ุชุฃูุฏ ุฃู INTEGRATION_ENABLED=true
4. ุฃุนุฏ ุชุดุบูู npm run dev
```

### ูุดููุฉ: "Unauthorized"
```
โ ุงูุญู:
GSHEETS_SECRET_KEY ูู .env.local ูุฌุจ ุฃู ูุทุงุจู SECRET_KEY ูู Apps Script
```

### ูุดููุฉ: ุงูุทูุจ ูุง ูุธูุฑ ูู ุงูุดูุช
```
โ ุงูุชุญูู:
1. ุงูุชุญ Apps Script > Executions (ุณุฌู ุงูุชูููุฐ)
2. ูู ููุฌุฏ ุฃุฎุทุงุกุ
3. ุงูุชุญ Chrome DevTools > Console
4. ูู ููุฌุฏ ุฃุฎุทุงุก ูู ุงููุชุตูุญุ
5. ุฌุฑุจ ุงูุฏุงูุฉ testWebhook ูู Apps Script
```

### ูุดููุฉ: ุจุทุก ูู ุงูุฅุฑุณุงู
```
โ ุงูุญู:
ุฒุฏ ูููุฉ INTEGRATION_TIMEOUT_MS ูู .env.local:
INTEGRATION_TIMEOUT_MS=10000
```

### ููุงุญุธุฉ: ุชู ุญุฐู ุฑูู ุงูุทูุจ
```
โ ุชุญูู:
- ุฏุงูุฉ generateOrderId() ูู Apps Script ุชุนูู
- ุนููุฏ order_id ููุฌูุฏ ูู ุงูุดูุช
```

---

## ๐ฏ ูุตุงุฆุญ ูููุฉ

### ุงูุฃูุงู
```
โ ูุง ุชุดุงุฑู GSHEETS_SECRET_KEY ุนููุงู
โ ูุง ุชุถุน .env.local ูู Git
โ ุบููุฑ SECRET_KEY ููู ูุดุฑูุน ููู
โ ุงุณุชุฎุฏู Apps Script Execute as "Me"
```

### ุงูุฃุฏุงุก
```
โ Google Sheets ูุฏุนู ุขูุงู ุงูุทูุจุงุช
โ ุฅุฐุง ุฒุงุฏ ุงูุญูู: ุงูุชูู ูู Airtable ุฃู ูุงุนุฏุฉ ุจูุงูุงุช
โ ุงุณุชุฎุฏู INTEGRATION_RETRY_ATTEMPTS=2 ููููุซูููุฉ
```

### ุงูุตูุงูุฉ
```
โ ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู Apps Script
โ ุงุญุชูุธ ุจูุงุฆูุฉ ูุนุฑูุงุช ุงูุดูุชุงุช ููู ุนููู
โ ุฑุงุฌุน Executions ูู Apps Script ุฏูุฑูุงู
```

---

## ๐ ูููู ุงูุจูุงูุงุช ูู Google Sheet

```
| ุงูุชุงุฑูุฎ ูุงูููุช | ุงูููุชุฌ | ุงูุณุนุฑ | ุงููููุฉ | ููุน ุงูุชูุตูู | ุฑุณูู ุงูุชูุตูู | ุงูุฅุฌูุงูู | ุงุณู ุงูุนููู | ุงููุงุชู | ุงูููุงูุฉ | ุงูุจูุฏูุฉ | ุงูุนููุงู | ููุงุญุธุงุช | ุงูุญุงูุฉ |
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

ูุจู ุงูุชุณููู ููุนููู:

```
โ Google Sheet ููุดุฃ ููุณูู ุจุดูู ูุงุถุญ
โ Apps Script ููุดูุฑ ููุนูู
โ testWebhook ูุฌุญ
โ GSHEETS_WEBAPP_URL ููุถูุน ูู .env.local
โ GSHEETS_SECRET_KEY ูุทุงุจู Apps Script
โ INTEGRATION_ENABLED=true
โ ุงุฎุชุจุงุฑ ุทูุจ ุญูููู ูู ุงููููุน ูุฌุญ
โ ุงูุจูุงูุงุช ุธูุฑุช ูู ุงูุดูุช ุจุดูู ุตุญูุญ
โ ุชู ูุดุงุฑูุฉ ุงูุดูุช ูุน ุงูุนููู (View/Edit)
โ ุชู ุชุณููู ุฑุงุจุท ุงููููุน ููุนููู
```

---

## ๐ ุชู ุจูุฌุงุญ!

ุงูุขู ูุฏูู:
- โ ุชูุงูู ูุงูู ูุน Google Sheets
- โ ุญูุธ ุชููุงุฆู ููุทูุจุงุช
- โ ุณูููุฉ ุงููุณุฎ ูุนููุงุก ุฌุฏุฏ
- โ ูุธุงู ุขูู ูููุซูู

**ุฌุงูุฒ ููุฅูุชุงุฌ! ๐**
